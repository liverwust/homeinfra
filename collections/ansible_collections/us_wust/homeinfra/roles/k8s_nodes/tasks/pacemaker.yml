---
# Install and set up Pacemaker / Corosync for Floating IP support

- name: Install control-plane cluster packages
  ansible.builtin.apt:
    name:
      - pacemaker
      - pacemaker-cli-utils
      - pcs

- name: Enable the pcs service
  ansible.builtin.service:
    name: pcsd.service
    enabled: true
    state: started

- name: Set the hacluster user's password for recovery purposes
  ansible.builtin.user:
    name: "hacluster"
    password: "{{ k8s_nodes_hacluster_password_hash }}"
